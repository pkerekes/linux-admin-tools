#!/bin/bash
#
# example: sh us_block-country.sh
#
FILE="$0"
ISO="${FILE%%_*}"
IPTABLES_MAKE='/etc/iptables/iptables_make.sh'
#
case "$ISO" in
af) export COUNTRY=afghanistan;;
al) export COUNTRY=albania;;
dz) export COUNTRY=algeria;;
as) export COUNTRY=american-samoa;;
ad) export COUNTRY=andorra;;
ao) export COUNTRY=angola;;
ai) export COUNTRY=anguilla;;
ag) export COUNTRY=antigua-and-barbuda;;
ar) export COUNTRY=argentina;;
am) export COUNTRY=armenia;;
aw) export COUNTRY=aruba;;
au) export COUNTRY=australia;;
at) export COUNTRY=austria;;
az) export COUNTRY=azerbaijan;;
bs) export COUNTRY=bahamas;;
bh) export COUNTRY=bahrain;;
bd) export COUNTRY=bangladesh;;
bb) export COUNTRY=barbados;;
by) export COUNTRY=belarus;;
be) export COUNTRY=belgium;;
bz) export COUNTRY=belize;;
bj) export COUNTRY=benin;;
bm) export COUNTRY=bermuda;;
bt) export COUNTRY=bhutan;;
bo) export COUNTRY=bolivia;;
ba) export COUNTRY=bosnia-and-herzegovina;;
bw) export COUNTRY=botswana;;
br) export COUNTRY=brazil;;
io) export COUNTRY=british-indian-ocean-territory;;
bn) export COUNTRY=brunei-darussalam;;
bg) export COUNTRY=bulgaria;;
bf) export COUNTRY=burkina-faso;;
bi) export COUNTRY=burundi;;
kh) export COUNTRY=cambodia;;
cm) export COUNTRY=cameroon;;
ca) export COUNTRY=canada;;
cv) export COUNTRY=cape-verde;;
ky) export COUNTRY=cayman-islands;;
cf) export COUNTRY=central-african-republic;;
td) export COUNTRY=chad;;
cl) export COUNTRY=chile;;
cn) export COUNTRY=china;;
co) export COUNTRY=colombia;;
km) export COUNTRY=comoros;;
cg) export COUNTRY=congo;;
cd) export COUNTRY=congo-democratic-republic;;
ck) export COUNTRY=cook-islands;;
cr) export COUNTRY=costa-rica;;
ci) export COUNTRY=cote-divoire;;
hr) export COUNTRY=croatia;;
cu) export COUNTRY=cuba;;
cy) export COUNTRY=cyprus;;
cz) export COUNTRY=czech-republic;;
dk) export COUNTRY=denmark;;
dj) export COUNTRY=djibouti;;
dm) export COUNTRY=dominica;;
do) export COUNTRY=dominican-republic;;
ec) export COUNTRY=ecuador;;
eg) export COUNTRY=egypt;;
sv) export COUNTRY=el-salvador;;
gq) export COUNTRY=equatorial-guinea;;
er) export COUNTRY=eritrea;;
ee) export COUNTRY=estonia;;
et) export COUNTRY=ethiopia;;
fo) export COUNTRY=faroe-islands;;
fj) export COUNTRY=fiji;;
fi) export COUNTRY=finland;;
fr) export COUNTRY=france;;
gf) export COUNTRY=french-guiana;;
pf) export COUNTRY=french-polynesia;;
ga) export COUNTRY=gabon;;
gm) export COUNTRY=gambia;;
ge) export COUNTRY=georgia;;
de) export COUNTRY=germany;;
gh) export COUNTRY=ghana;;
gi) export COUNTRY=gibraltar;;
gr) export COUNTRY=greece;;
gl) export COUNTRY=greenland;;
gd) export COUNTRY=grenada;;
gp) export COUNTRY=guadeloupe;;
gu) export COUNTRY=guam;;
gt) export COUNTRY=guatemala;;
gn) export COUNTRY=guinea;;
gw) export COUNTRY=guinea-bissau;;
gy) export COUNTRY=guyana;;
ht) export COUNTRY=haiti;;
va) export COUNTRY=vatican-city-state;;
hn) export COUNTRY=honduras;;
hk) export COUNTRY=hong-kong;;
hu) export COUNTRY=hungary;;
is) export COUNTRY=iceland;;
in) export COUNTRY=india;;
id) export COUNTRY=indonesia;;
ir) export COUNTRY=iran-islamic-republic;;
iq) export COUNTRY=iraq;;
ie) export COUNTRY=ireland;;
im) export COUNTRY=isle-of-man;;
il) export COUNTRY=israel;;
it) export COUNTRY=italy;;
jm) export COUNTRY=jamaica;;
jp) export COUNTRY=japan;;
je) export COUNTRY=jersey;;
jo) export COUNTRY=jordan;;
kz) export COUNTRY=kazakhstan;;
ke) export COUNTRY=kenya;;
ki) export COUNTRY=kiribati;;
kp) export COUNTRY=korea-democratic;;
kr) export COUNTRY=korea--republic;;
kw) export COUNTRY=kuwait;;
kg) export COUNTRY=kyrgyzstan;;
la) export COUNTRY=lao-peoples-democratic;;
lv) export COUNTRY=latvia;;
lb) export COUNTRY=lebanon;;
ls) export COUNTRY=lesotho;;
lr) export COUNTRY=liberia;;
ly) export COUNTRY=libyan-arab-jamahiriya;;
li) export COUNTRY=liechtenstein;;
lt) export COUNTRY=lithuania;;
lu) export COUNTRY=luxembourg;;
mo) export COUNTRY=macao;;
mk) export COUNTRY=macedonia;;
mg) export COUNTRY=madagascar;;
mw) export COUNTRY=malawi;;
my) export COUNTRY=malaysia;;
mv) export COUNTRY=maldives;;
ml) export COUNTRY=mali;;
mt) export COUNTRY=malta;;
mh) export COUNTRY=marshall-islands;;
mq) export COUNTRY=martinique;;
mr) export COUNTRY=mauritania;;
mu) export COUNTRY=mauritius;;
yt) export COUNTRY=mayotte;;
mx) export COUNTRY=mexico;;
fm) export COUNTRY=micronesia-federated;;
md) export COUNTRY=moldova-republic;;
mc) export COUNTRY=monaco;;
mn) export COUNTRY=mongolia;;
me) export COUNTRY=montenegro;;
ms) export COUNTRY=montserrat;;
ma) export COUNTRY=morocco;;
mz) export COUNTRY=mozambique;;
mm) export COUNTRY=myanmar;;
na) export COUNTRY=namibia;;
nr) export COUNTRY=nauru;;
np) export COUNTRY=nepal;;
nl) export COUNTRY=netherlands;;
nc) export COUNTRY=new-caledonia;;
nz) export COUNTRY=new-zealand;;
ni) export COUNTRY=nicaragua;;
ne) export COUNTRY=niger;;
ng) export COUNTRY=nigeria;;
nu) export COUNTRY=niue;;
nf) export COUNTRY=norfolk-island;;
mp) export COUNTRY=northern-mariana-islands;;
no) export COUNTRY=norway;;
om) export COUNTRY=oman;;
pk) export COUNTRY=pakistan;;
pw) export COUNTRY=palau;;
ps) export COUNTRY=palestinian-territory;;
pa) export COUNTRY=panama;;
pg) export COUNTRY=papua-new-guinea;;
py) export COUNTRY=paraguay;;
pe) export COUNTRY=peru;;
ph) export COUNTRY=philippines;;
pl) export COUNTRY=poland;;
pt) export COUNTRY=portugal;;
pr) export COUNTRY=puerto-rico;;
qa) export COUNTRY=qatar;;
re) export COUNTRY=reunion;;
ro) export COUNTRY=romania;;
ru) export COUNTRY=russian-federation;;
rw) export COUNTRY=rwanda;;
kn) export COUNTRY=saint-kitts;;
lc) export COUNTRY=saint-lucia;;
pm) export COUNTRY=saint-pierre;;
vc) export COUNTRY=saint-vincent;;
ws) export COUNTRY=samoa;;
sm) export COUNTRY=san-marino;;
st) export COUNTRY=sao-tome-and-principe;;
sa) export COUNTRY=saudi-arabia;;
sn) export COUNTRY=senegal;;
rs) export COUNTRY=serbia;;
sc) export COUNTRY=seychelles;;
sl) export COUNTRY=sierra-leone;;
sg) export COUNTRY=singapore;;
sk) export COUNTRY=slovakia;;
si) export COUNTRY=slovenia;;
sb) export COUNTRY=solomon-islands;;
so) export COUNTRY=somalia;;
za) export COUNTRY=south-africa;;
es) export COUNTRY=spain;;
lk) export COUNTRY=sri-lanka;;
sd) export COUNTRY=sudan;;
sr) export COUNTRY=suriname;;
sz) export COUNTRY=swaziland;;
se) export COUNTRY=sweden;;
ch) export COUNTRY=switzerland;;
sy) export COUNTRY=syrian-arab-republic;;
tw) export COUNTRY=taiwan;;
tj) export COUNTRY=tajikistan;;
tz) export COUNTRY=tanzania--united-republic;;
th) export COUNTRY=thailand;;
tl) export COUNTRY=timor-leste;;
tg) export COUNTRY=togo;;
tk) export COUNTRY=tokelau;;
to) export COUNTRY=tonga;;
tt) export COUNTRY=trinidad-and-tobago;;
tn) export COUNTRY=tunisia;;
tr) export COUNTRY=turkey;;
tm) export COUNTRY=turkmenistan;;
tc) export COUNTRY=turks-and-caicos;;
tv) export COUNTRY=tuvalu;;
ug) export COUNTRY=uganda;;
ua) export COUNTRY=ukraine;;
ae) export COUNTRY=united-arab-emirates;;
gb) export COUNTRY=united-kingdom;;
us) export COUNTRY=united-states;;
uy) export COUNTRY=uruguay;;
uz) export COUNTRY=uzbekistan;;
vu) export COUNTRY=vanuatu;;
ve) export COUNTRY=venezuela;;
vn) export COUNTRY=viet-nam;;
vg) export COUNTRY=virgin-islands-british;;
vi) export COUNTRY=virgin-islands-u-s;;
wf) export COUNTRY=wallis-and-futuna;;
ye) export COUNTRY=yemen;;
zm) export COUNTRY=zambia;;
zw) export COUNTRY=zimbabwe;;
esac
#
ipset -N ${COUNTRY} hash:net
rm /etc/iptables/${ISO%%_*}.zone
wget -P /etc/iptables/  http://www.ipdeny.com/ipblocks/data/countries/${ISO%%_*}.zone
for i in $(cat /etc/iptables/${ISO%%_*}.zone ); do ipset -A ${COUNTRY} $i; done
#
echo '$IPT -A INPUT -p tcp -m set --match-set '${COUNTRY}' src -j DROP'
sed -i -e 's/#$IPT -A INPUT -p tcp -m set --match-set '"${COUNTRY}"' src -j DROP/$IPT -A INPUT -p tcp -m set --match-set '"${COUNTRY}"' src -j DROP/g' ${IPTABLES_MAKE}
#
sh /etc/iptables/iptables_make.sh
#
#/sbin/iptables-restore < /etc/iptables/iptables.firewall.rules

